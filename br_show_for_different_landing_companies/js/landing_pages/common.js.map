{"version":3,"sources":["../../../../src/javascript/landing_pages/common.js"],"names":["checkWidth","mq","window","matchMedia","matches","document","getElementById","scrollHeight","toggleMobileMenu","toggleButton","navbar","navbar_item","getElementsByClassName","el_language_dropdown","addEventListener","e","stopPropagation","classList","toggle","test","toggleAllSiblings","parentNode","filterById","remove","collapseMenu","scrollTo","to","duration","start","pageYOffset","change","increment","currentTime","animateScroll","val","Math","easeInOutQuad","body","scrollTop","documentElement","setTimeout","current_time","start_value","change_in_value","curr_time","getParamValue","url","key","regex","RegExp","results","exec","decodeURIComponent","replace","allLanguages","getLanguage","language","location","href","toLowerCase","split","slice","find","l","indexOf","urlFor","path","lang","substring","length","urlForLanguage","default_language","trim","wsConnect","config_server","localStorage","getItem","server_url","endpointNotification","WebSocket","getAppId","hostname","wsSend","ws","request","send","JSON","stringify","el_end_note","createElement","setAttribute","innerHTML","appendChild","style","offsetHeight","setSession","value","sessionStorage","setItem","NodeList","prototype","forEach","callback","thisArg","i","call","elem","id","filter","class_name","el","firstChild","nodeType","nextSibling","setupCrowdin","isInContextEnvironment","el_lang","display","_jipt","push","crowdinScript","protocol","commonOnload","jpClient","recordAffiliateExposure","Url","token","showAfffiliatePopup","token_length","is_subsidiary","cookie_token","Cookies","getJSON","t","cookie_hash","toString","s","set","expires","domain","join","clients_country","xmlhttp","XMLHttpRequest","container_id","el_affiliate_popup","isLoggedIn","onreadystatechange","readyState","DONE","status","div","parser","DOMParser","parseFromString","response","element","add","el_affiliate_btn","removeEventListener","close","open","get","loginid","client_object","getAllAccountsObject","current_client","Array","isArray","parse"],"mappings":"uOAAA,mCACA;AACA,QAASA,WAAT,EAAsB,CAClB,GAAMC,IAAKC,OAAOC,UAAP,CAAkB,qBAAlB,CAAX,CACA,MAAQF,IAAGG,OAAH,CAAa,EAAb,CAAkB,CAACC,SAASC,cAAT,CAAwB,YAAxB,GAAyC,EAA1C,EAA8CC,YAC3E,CAED,QAASC,iBAAT,EAA4B,CACxB,GAAMC,cAAeJ,SAASC,cAAT,CAAwB,aAAxB,CAArB,CACA,GAAI,CAACG,YAAL,CAAmB,OACnB,GAAMC,QAAeL,SAASC,cAAT,CAAwB,YAAxB,CAArB,CACA,GAAMK,aAAeN,SAASO,sBAAT,CAAgC,iBAAhC,EAAmD,CAAnD,CAArB,CACA,GAAMC,sBAAuBR,SAASO,sBAAT,CAAgC,mBAAhC,EAAqD,CAArD,CAA7B,CACAH,aAAaK,gBAAb,CAA8B,OAA9B,CAAuC,SAACC,CAAD,CAAO,CAC1CA,EAAEC,eAAF,GACAN,OAAOO,SAAP,CAAiBC,MAAjB,CAAwB,QAAxB,EACAP,YAAYM,SAAZ,CAAsBC,MAAtB,CAA6B,QAA7B,EACA,GAAIL,sBAAwB,OAAOM,IAAP,CAAYN,qBAAqBI,SAAjC,CAA5B,CAAyE,CACrEG,kBAAkBP,qBAAqBQ,UAAvC,CAAmDC,UAAnD,CAA+D,WAA/D,EACAT,qBAAqBI,SAArB,CAA+BM,MAA/B,CAAsC,MAAtC,CACH,CACJ,CARD,CASH,CAED,QAASC,aAAT,EAAwB,CACpB,GAAMd,QAAcL,SAASC,cAAT,CAAwB,YAAxB,CAApB,CACA,GAAMK,aAAcN,SAASO,sBAAT,CAAgC,iBAAhC,EAAmD,CAAnD,CAApB,CACA,GAAIF,QAAUC,WAAd,CAA2B,CACvBD,OAAOO,SAAP,CAAiBM,MAAjB,CAAwB,QAAxB,EACAZ,YAAYM,SAAZ,CAAsBM,MAAtB,CAA6B,QAA7B,CACH,CACJ,CAED;AACA;AACA,QAASE,SAAT,CAAkBC,EAAlB,CAAuC,IAAjBC,SAAiB,2DAAN,IAAM,CACnC,GAAI,MAAOD,GAAP,GAAc,WAAlB,CAA+B,OAC/B,GAAME,OAAY1B,OAAO2B,WAAzB,CACA,GAAMC,QAAYJ,GAAKE,KAAvB,CACA,GAAMG,WAAY,EAAlB,CACA,GAAIC,aAAc,CAAlB,CAEA,GAAMC,eAAgB,QAAhBA,cAAgB,EAAM,CACxBD,aAAeD,SAAf,CACA,GAAMG,KAAMC,KAAKC,aAAL,CAAmBJ,WAAnB,CAAgCJ,KAAhC,CAAuCE,MAAvC,CAA+CH,QAA/C,CAAZ,CACAtB,SAASgC,IAAT,CAAcC,SAAd,CAA0BJ,GAA1B,CACA7B,SAASkC,eAAT,CAAyBD,SAAzB,CAAqCJ,GAArC,CACA,GAAIF,YAAcL,QAAlB,CAA4B,CACxBa,WAAWP,aAAX,CAA0BF,SAA1B,CACH,CACJ,CARD,CASAE,eACH,CAEDE,KAAKC,aAAL,CAAqB,SAASK,YAAT,CAAuBC,WAAvB,CAAoCC,eAApC,CAAqDhB,QAArD,CAA+D,CAChF,GAAIiB,WAAYH,YAAhB,CACAG,WAAajB,SAAW,CAAxB,CACA,GAAIiB,UAAY,CAAhB,CAAmB,MAAOD,iBAAkB,CAAlB,CAAsBC,SAAtB,CAAkCA,SAAlC,CAA8CF,WAArD,CACnBE,YACA,MAAO,CAACD,eAAD,CAAmB,CAAnB,EAAwBC,WAAaA,UAAY,CAAzB,EAA8B,CAAtD,EAA2DF,WACrE,CAND,CAQA,QAASG,cAAT,CAAuBC,GAAvB,CAA4BC,GAA5B,CAAiC,CAC7B,GAAMC,OAAU,GAAIC,OAAJ,QAAkBF,GAAlB,qBAAhB,CACA,GAAMG,SAAUF,MAAMG,IAAN,CAAWL,GAAX,CAAhB,CACA,GAAI,CAACI,OAAD,EAAY,CAACA,QAAQ,CAAR,CAAjB,CAA6B,MAAO,EAAP,CAC7B,MAAOE,oBAAmBF,QAAQ,CAAR,EAAWG,OAAX,CAAmB,KAAnB,CAA0B,GAA1B,CAAnB,CACV,CAED,QAASC,aAAT,EAAwB,CACpB,MAAO,CAAE,IAAF,CAAQ,IAAR,CAAc,IAAd,CAAoB,IAApB,CAA0B,IAA1B,CAAgC,IAAhC,CAAsC,IAAtC,CAA4C,IAA5C,CAAkD,IAAlD,CAAwD,IAAxD,CAA8D,IAA9D,CAAoE,IAApE,CAA0E,IAA1E,CAAgF,OAAhF,CAAyF,OAAzF,CAAkG,KAAlG,CACV,CAED,QAASC,YAAT,EAAuB,CACnB,GAAMC,UAAWtD,OAAOuD,QAAP,CAAgBC,IAAhB,CAAqBC,WAArB,GAAmCC,KAAnC,CAAyC,GAAzC,EAA8CC,KAA9C,CAAoD,CAApD,EAAuDC,IAAvD,CAA4D,SAACC,CAAD,QAAOT,gBAAeU,OAAf,CAAuBD,CAAvB,GAA6B,CAApC,CAA5D,CAAjB,CACA,MAAOP,WAAY,IACtB,CAED,QAASS,OAAT,CAAgBC,IAAhB,CAAsB,CAClB,GAAMC,MAAOZ,aAAb,CACA,GAAMT,KAAO5C,OAAOuD,QAAP,CAAgBC,IAA7B,CACA,SAAUZ,IAAIsB,SAAJ,CAAc,CAAd,CAAiBtB,IAAIkB,OAAJ,KAAgBG,IAAhB,MAA2BA,KAAKE,MAAhC,CAAyC,CAA1D,CAAV,CAAyEH,IAAzE,QACH,CAED,QAASI,eAAT,CAAyBH,IAAzB,CAAoF,IAArDrB,IAAqD,2DAA/C5C,OAAOuD,QAAP,CAAgBC,IAA+B,IAAzBa,iBAAyB,2DAAN,IAAM,CAChF,MAAOzB,KAAIO,OAAJ,CAAY,GAAIJ,OAAJ,KAAeM,aAAf,KAAiC,GAAjC,CAAZ,KAAuD,CAACY,MAAQI,gBAAT,EAA2BC,IAA3B,GAAkCb,WAAlC,EAAvD,KACV,CAED,QAASc,UAAT,EAAqB,CACjB,GAAMC,eAAgBC,aAAaC,OAAb,CAAqB,mBAArB,CAAtB,CACA,GAAMC,YAAgBH,eAAiB,uBAAvC,CACAI,qBAAqBJ,aAArB,EAEA,MAAO,IAAIK,UAAJ,UAAuBF,UAAvB,0BAA0DG,UAA1D,OAA0EzB,aAA1E,CACV,CAED,QAASyB,SAAT,EAAoB,CAChB,MAAOL,cAAaC,OAAb,CAAqB,eAArB,IAA0C,wBAAwBzD,IAAxB,CAA6BjB,OAAOuD,QAAP,CAAgBwB,QAA7C,EAAyD,MAAzD,CAAkE,GAA5G,CACV,CAED,QAASC,OAAT,CAAgBC,EAAhB,CAAoBC,OAApB,CAA6B,CACzB,GAAID,IAAMC,OAAN,EAAiB,OAAOA,QAAP,mCAAOA,OAAP,KAAmB,QAAxC,CAAkD,CAC9CD,GAAGE,IAAH,CAAQC,KAAKC,SAAL,CAAeH,OAAf,CAAR,CACH,CACJ,CAED,QAASN,qBAAT,CAA+BJ,aAA/B,CAA8C,CAC1C,GAAIA,eAAiBA,cAAcL,MAAd,CAAuB,CAAxC,EAA6C,CAAChE,SAASC,cAAT,CAAwB,UAAxB,CAAlD,CAAuF,CACnF,GAAMkF,aAAcnF,SAASoF,aAAT,CAAuB,KAAvB,CAApB,CACAD,YAAYE,YAAZ,CAAyB,IAAzB,CAA+B,UAA/B,EACAF,YAAYG,SAAZ,wBAA+C1B,OAAO,UAAP,CAA/C,uBAAuFS,aAAvF,CACArE,SAASgC,IAAT,CAAcuD,WAAd,CAA0BJ,WAA1B,EACAnF,SAASgC,IAAT,CAAcwD,KAAd,CAAoB,gBAApB,EAA2CL,YAAYM,YAAvD,KACH,CACJ,CAED,QAASC,WAAT,CAAoBhD,GAApB,CAAyBiD,KAAzB,CAAgC,CAC5B,GAAI,MAAOC,eAAP,GAA0B,WAA9B,CAA2C,CACvC,GAAI,CACAA,eAAeC,OAAf,CAAuBnD,GAAvB,CAA4BiD,KAA5B,EACA,MAAO,KACV,CAAC,MAAOjF,CAAP,CAAU,CACR,MAAO,MACV,CACJ,CACD,MAAO,MACV,CAED;AACA,GAAIb,OAAOiG,QAAP,EAAmB,CAACA,SAASC,SAAT,CAAmBC,OAA3C,CAAoD,CAChDF,SAASC,SAAT,CAAmBC,OAAnB,CAA6B,SAAUC,QAAV,CAAsC,IAAlBC,QAAkB,2DAARrG,MAAQ,CAC/D,IAAK,GAAIsG,GAAI,CAAb,CAAgBA,EAAI,KAAKnC,MAAzB,CAAiCmC,GAAjC,CAAsC,CAClCF,SAASG,IAAT,CAAcF,OAAd,CAAuB,KAAKC,CAAL,CAAvB,CAAgCA,CAAhC,CAAmC,IAAnC,CACH,CACJ,CACJ,CAED,QAASlF,WAAT,CAAoBoF,IAApB,CAA0B,CACtB,MAAO,CAAG,gBAAgBvF,IAAhB,CAAqBuF,KAAKC,EAA1B,CACb,CAED,QAASvF,kBAAT,CAA2BsF,IAA3B,CAAiCE,MAAjC,CAAyCC,UAAzC,CAAqD,CACjD,GAAIC,IAAKJ,KAAKrF,UAAL,CAAgB0F,UAAzB,CACA,EAAG,CACC,GAAID,GAAGE,QAAH,GAAgB,CAAhB,GAAsB,CAACJ,MAAD,EAAWA,OAAOE,EAAP,CAAjC,CAAJ,CAAkD,CAC9CA,GAAG7F,SAAH,CAAaC,MAAb,CAAoB2F,UAApB,CACH,CACDC,GAAKA,GAAGG,WACX,CALD,MAKSH,EALT,CAMH,CAED,QAASI,aAAT,EAAwB,CACpB,GAAMC,wBAAyB,QAAzBA,uBAAyB,SAC3B,oDAAmDhG,IAAnD,CAAwDjB,OAAOuD,QAAP,CAAgBC,IAAxE,GACI,OAAOvC,IAAP,CAAYoC,aAAZ,CAFuB,CAA/B,CAKA,GAAI4D,wBAAJ,CAA8B,CAC1B,GAAMC,SAAU/G,SAASC,cAAT,CAAwB,UAAxB,CAAhB,CACA,GAAI8G,OAAJ,CAAaA,QAAQvB,KAAR,CAAcwB,OAAd,CAAwB,MAAxB,CACb,yCACAnH,OAAOoH,KAAP,CAAe,EAAf,CACApH,OAAOoH,KAAP,CAAaC,IAAb,CAAkB,CAAC,SAAD,CAAY,eAAZ,CAAlB,EACA,wCACA,GAAIlH,SAASgC,IAAb,CAAmB,CACf,GAAMmF,eAAgBnH,SAASoF,aAAT,CAAuB,QAAvB,CAAtB,CACA+B,cAAc9B,YAAd,CAA2B,KAA3B,CAAqCrF,SAASoD,QAAT,CAAkBgE,QAAvD,mCACAD,cAAc9B,YAAd,CAA2B,MAA3B,CAAmC,iBAAnC,EACArF,SAASgC,IAAT,CAAcuD,WAAd,CAA0B4B,aAA1B,CACH,CACJ,CACJ,CAED,QAASE,aAAT,EAAwB,CACpBR,cACH,CAED,QAASS,SAAT,EAAoB,CAChB,MAAQpE,iBAAkB,IAC7B,CAED,QAASqE,wBAAT,EAAmC,CAC/B,GAAMC,KAAQ3H,OAAOuD,QAArB,CACA,GAAMqE,OAAQjF,cAAcgF,GAAd,CAAmB,GAAnB,CAAd,CACA,GAAI,CAACC,KAAD,EAAUA,MAAMzD,MAAN,GAAiB,EAA/B,CAAmC,CAC/B,MAAO,MACV,CAED0D,sBAEA,GAAMC,cAAgBF,MAAMzD,MAA5B,CACA,GAAM4D,eAAgB,QAAQ9G,IAAR,CAAa0B,cAAcgF,GAAd,CAAmB,GAAnB,CAAb,CAAtB,CAEA,oBACA,GAAMK,cAAeC,QAAQC,OAAR,CAAgB,oBAAhB,CAArB,CACA,GAAIF,YAAJ,CAAkB,CACd;AACA,GAAID,eAAiBC,YAAjB,EAAiCA,aAAaG,CAAlD,CAAqD,CACjD,MAAO,MACV,CACJ,CAED;AACA,GAAMC,aAAc,EAApB,CACA,GAAIN,eAAiB,EAArB,CAAyB,CACrBM,YAAYD,CAAZ,CAAgBP,MAAMS,QAAN,EACnB,CACD,GAAIN,aAAJ,CAAmB,CACfK,YAAYE,CAAZ,CAAgB,GACnB,CAEDL,QAAQM,GAAR,CAAY,oBAAZ,CAAkCH,WAAlC,CAA+C,CAC3CI,QAAS,GADkC,CAC7B;AACdxE,KAAS,GAFkC,CAG3CyE,OAAS,iBAAiBxH,IAAjB,CAAsBsC,SAASwB,QAA/B,MAA+CxB,SAASwB,QAAT,CAAkBrB,KAAlB,CAAwB,GAAxB,EAA6BC,KAA7B,CAAmC,CAAC,CAApC,EAAuC+E,IAAvC,CAA4C,GAA5C,CAA/C,CAAoGnF,SAASwB,QAH3E,CAA/C,EAKA,MAAO,KACV,CAED,QAAS8C,oBAAT,EAA+B,CAC3B,GAAMc,iBAAkB5C,eAAerB,OAAf,CAAuB,iBAAvB,CAAxB,CACA,GAAMkE,SAAU,GAAIC,eAApB,CAEA,GAAMC,cAAqB,4BAA3B,CACA,GAAMC,oBAAqB5I,SAASC,cAAT,CAAwB0I,YAAxB,CAA3B,CAEA,GAAIE,YAAJ,CAAkB,OAClB,GAAIvB,YAAckB,kBAAoB,IAAtC,CAA4C,CACxCC,QAAQK,kBAAR,CAA6B,UAAM,CAC/B,GAAIL,QAAQM,UAAR,GAAuBL,eAAeM,IAAtC,EAA8CP,QAAQQ,MAAR,GAAmB,GAArE,CAA0E,CACtE,GAAMC,KAAUlJ,SAASoF,aAAT,CAAuB,KAAvB,CAAhB,CACA,GAAM+D,QAAU,GAAIC,UAApB,CACA,GAAM3C,IAAU0C,OAAOE,eAAP,CAAuBZ,QAAQa,QAA/B,CAAyC,WAAzC,CAAhB,CACA,GAAMC,SAAU9C,GAAGzE,IAAH,CAAQ0E,UAAxB,CACAwC,IAAItI,SAAJ,CAAc4I,GAAd,CAAkB,UAAlB,EACAN,IAAI3D,WAAJ,CAAgBgE,OAAhB,EACAX,mBAAmBrD,WAAnB,CAA+B2D,GAA/B,EAEA,GAAMO,kBAAmBzJ,SAASC,cAAT,CAAwB,uBAAxB,CAAzB,CACAwJ,iBAAiBC,mBAAjB,CAAqC,OAArC,CAA8CC,KAA9C,EACAF,iBAAiBhJ,gBAAjB,CAAkC,OAAlC,CAA2CkJ,KAA3C,EAEA3J,SAASgC,IAAT,CAAcpB,SAAd,CAAwB4I,GAAxB,CAA4B,aAA5B,CACH,CACJ,CAhBD,CAkBAf,QAAQmB,IAAR,CAAa,KAAb,CAAoBhG,OAAO,sBAAP,CAApB,CAAoD,IAApD,EACA6E,QAAQzD,IAAR,EACH,CAED,QAAS2E,MAAT,EAAiB,CACb3J,SAASgC,IAAT,CAAcpB,SAAd,CAAwBM,MAAxB,CAA+B,aAA/B,EACA0H,mBAAmB1H,MAAnB,EACH,CACJ,CAED,QAAS2H,WAAT,EAAuB,CACnB;;;;;OAMA,QAASgB,IAAT,CAAanH,GAAb,CAAoE,IAAlDoH,QAAkD,2DAAxCxF,aAAaC,OAAb,CAAqB,gBAArB,CAAwC,CAChE,GAAIoB,aAAJ,CACA,GAAMoE,eAAgBC,sBAAtB,CACA,GAAItH,MAAQ,SAAZ,CAAuB,CACnBiD,MAAQmE,SAAWxF,aAAaC,OAAb,CAAqB,gBAArB,CACtB,CAFD,IAEO,CACH,GAAM0F,gBAAiBF,cAAcD,OAAd,GAA0BE,uBAAuBF,OAAvB,CAA1B,EAA6D,EAApF,CAEAnE,MAAQjD,IAAMuH,eAAevH,GAAf,CAAN,CAA4BuH,cACvC,CACD,GAAI,CAACC,MAAMC,OAAN,CAAcxE,KAAd,CAAD,GAA0B,CAACA,KAAD,GAAW,CAAX,EAAgB,CAACA,KAAD,GAAW,CAA3B,EAAgCA,QAAU,MAA1C,EAAoDA,QAAU,OAAxF,CAAJ,CAAsG,CAClGA,MAAQV,KAAKmF,KAAL,CAAWzE,OAAS,KAApB,CACX,CACD,MAAOA,MACV,CAED,QAASqE,qBAAT,EAAgC,CAC5B,MAAO/E,MAAKmF,KAAL,CAAW9F,aAAaC,OAAb,CAAqB,iBAArB,CAAX,CACV,CAED,MAAOsF,KAAI,SAAJ,GAAkBA,IAAI,OAAJ,CAC5B","file":"common.js","sourcesContent":["/* eslint-disable no-unused-vars */\n// Check view width, add navbar height as offset if on desktop\nfunction checkWidth() {\n    const mq = window.matchMedia('(max-width: 1199px)');\n    return (mq.matches ? 50 : (document.getElementById('navigation') || '').scrollHeight);\n}\n\nfunction toggleMobileMenu() {\n    const toggleButton = document.getElementById('toggle-menu');\n    if (!toggleButton) return;\n    const navbar       = document.getElementById('navigation');\n    const navbar_item  = document.getElementsByClassName('navbar-collapse')[0];\n    const el_language_dropdown = document.getElementsByClassName('language-dropdown')[0];\n    toggleButton.addEventListener('click', (e) => {\n        e.stopPropagation();\n        navbar.classList.toggle('expand');\n        navbar_item.classList.toggle('expand');\n        if (el_language_dropdown && /show/.test(el_language_dropdown.classList)) {\n            toggleAllSiblings(el_language_dropdown.parentNode, filterById, 'invisible');\n            el_language_dropdown.classList.remove('show');\n        }\n    });\n}\n\nfunction collapseMenu() {\n    const navbar      = document.getElementById('navigation');\n    const navbar_item = document.getElementsByClassName('navbar-collapse')[0];\n    if (navbar && navbar_item) {\n        navbar.classList.remove('expand');\n        navbar_item.classList.remove('expand');\n    }\n}\n\n// scrollTo function with animation\n// - Gist reference: https://gist.github.com/andjosh/6764939\nfunction scrollTo(to, duration = 1000) {\n    if (typeof to === 'undefined') return;\n    const start     = window.pageYOffset;\n    const change    = to - start;\n    const increment = 20;\n    let currentTime = 0;\n\n    const animateScroll = () => {\n        currentTime += increment;\n        const val = Math.easeInOutQuad(currentTime, start, change, duration);\n        document.body.scrollTop = val;\n        document.documentElement.scrollTop = val;\n        if (currentTime < duration) {\n            setTimeout(animateScroll, increment);\n        }\n    };\n    animateScroll();\n}\n\nMath.easeInOutQuad = function(current_time, start_value, change_in_value, duration) {\n    let curr_time = current_time;\n    curr_time /= duration / 2;\n    if (curr_time < 1) return change_in_value / 2 * curr_time * curr_time + start_value;\n    curr_time--;\n    return -change_in_value / 2 * (curr_time * (curr_time - 2) - 1) + start_value;\n};\n\nfunction getParamValue(url, key) {\n    const regex   = new RegExp(`[?&]${key}(=([^&#]*)|&|#|$)`);\n    const results = regex.exec(url);\n    if (!results || !results[2]) return '';\n    return decodeURIComponent(results[2].replace(/\\+/g, ' '));\n}\n\nfunction allLanguages() {\n    return [ 'en', 'de', 'es', 'fr', 'id', 'it', 'ko', 'ja', 'pl', 'pt', 'ru', 'th', 'vi', 'zh_cn', 'zh_tw', 'ach' ];\n}\n\nfunction getLanguage() {\n    const language = window.location.href.toLowerCase().split('/').slice(3).find((l) => allLanguages().indexOf(l) >= 0);\n    return language || 'en';\n}\n\nfunction urlFor(path) {\n    const lang = getLanguage();\n    const url  = window.location.href;\n    return `${url.substring(0, url.indexOf(`/${lang}/`) + lang.length + 2)}${path}.html`;\n}\n\nfunction urlForLanguage (lang, url = window.location.href, default_language = 'en') {\n    return url.replace(new RegExp(`/${getLanguage()}/`, 'i'), `/${(lang || default_language).trim().toLowerCase()}/`);\n}\n\nfunction wsConnect() {\n    const config_server = localStorage.getItem('config.server_url');\n    const server_url    = config_server || 'frontend.binaryws.com';\n    endpointNotification(config_server);\n\n    return new WebSocket(`wss://${server_url}/websockets/v3?app_id=${getAppId()}&l=${getLanguage()}`);\n}\n\nfunction getAppId() {\n    return localStorage.getItem('config.app_id') || (/staging\\.binary\\.com/i.test(window.location.hostname) ? '1098' : '1');\n}\n\nfunction wsSend(ws, request) {\n    if (ws && request && typeof request === 'object') {\n        ws.send(JSON.stringify(request));\n    }\n}\n\nfunction endpointNotification (config_server) {\n    if (config_server && config_server.length > 0 && !document.getElementById('end_note')) {\n        const el_end_note = document.createElement('div');\n        el_end_note.setAttribute('id', 'end_note');\n        el_end_note.innerHTML = `The server <a href=\"${urlFor('endpoint')}\">endpoint</a> is: ${config_server}`;\n        document.body.appendChild(el_end_note);\n        document.body.style['padding-bottom'] = `${el_end_note.offsetHeight}px`;\n    }\n}\n\nfunction setSession(key, value) {\n    if (typeof sessionStorage !== 'undefined') {\n        try {\n            sessionStorage.setItem(key, value);\n            return true;\n        } catch (e) {\n            return false;\n        }\n    }\n    return false;\n}\n\n// NodeList foreach polyfill\nif (window.NodeList && !NodeList.prototype.forEach) {\n    NodeList.prototype.forEach = function (callback, thisArg = window) {\n        for (let i = 0; i < this.length; i++) {\n            callback.call(thisArg, this[i], i, this);\n        }\n    };\n}\n\nfunction filterById(elem) {\n    return !((/^(language)$/i.test(elem.id)));\n}\n\nfunction toggleAllSiblings(elem, filter, class_name) {\n    let el = elem.parentNode.firstChild;\n    do {\n        if (el.nodeType !== 3 && (!filter || filter(el))) {\n            el.classList.toggle(class_name);\n        }\n        el = el.nextSibling;\n    } while (el);\n}\n\nfunction setupCrowdin() {\n    const isInContextEnvironment = () => (\n        /^https:\\/\\/staging\\.binary\\.com\\/translations\\//i.test(window.location.href) &&\n            /ach/i.test(getLanguage())\n    );\n\n    if (isInContextEnvironment()) {\n        const el_lang = document.getElementById('language');\n        if (el_lang) el_lang.style.display = 'none';\n        /* eslint-disable no-underscore-dangle */\n        window._jipt = [];\n        window._jipt.push(['project', 'binary-static']);\n        /* eslint-enable no-underscore-dangle */\n        if (document.body) {\n            const crowdinScript = document.createElement('script');\n            crowdinScript.setAttribute('src', `${document.location.protocol}//cdn.crowdin.com/jipt/jipt.js`);\n            crowdinScript.setAttribute('type', 'text/javascript');\n            document.body.appendChild(crowdinScript);\n        }\n    }\n}\n\nfunction commonOnload() {\n    setupCrowdin();\n}\n\nfunction jpClient() {\n    return (getLanguage() === 'ja');\n}\n\nfunction recordAffiliateExposure() {\n    const Url   = window.location;\n    const token = getParamValue(Url, 't');\n    if (!token || token.length !== 32) {\n        return false;\n    }\n\n    showAfffiliatePopup();\n\n    const token_length  = token.length;\n    const is_subsidiary = /\\w{1}/.test(getParamValue(Url, 's'));\n\n    /* global Cookies */\n    const cookie_token = Cookies.getJSON('affiliate_tracking');\n    if (cookie_token) {\n        // Already exposed to some other affiliate.\n        if (is_subsidiary && cookie_token && cookie_token.t) {\n            return false;\n        }\n    }\n\n    // Record the affiliate exposure. Overwrite existing cookie, if any.\n    const cookie_hash = {};\n    if (token_length === 32) {\n        cookie_hash.t = token.toString();\n    }\n    if (is_subsidiary) {\n        cookie_hash.s = '1';\n    }\n\n    Cookies.set('affiliate_tracking', cookie_hash, {\n        expires: 365, // expires in 365 days\n        path   : '/',\n        domain : /\\.binary\\.com/i.test(location.hostname) ? `.${location.hostname.split('.').slice(-2).join('.')}` : location.hostname,\n    });\n    return true;\n}\n\nfunction showAfffiliatePopup() {\n    const clients_country = sessionStorage.getItem('clients_country');\n    const xmlhttp = new XMLHttpRequest();\n\n    const container_id       = 'affiliate_disclaimer_popup';\n    const el_affiliate_popup = document.getElementById(container_id);\n\n    if (isLoggedIn()) return;\n    if (jpClient() || clients_country === 'jp') {\n        xmlhttp.onreadystatechange = () => {\n            if (xmlhttp.readyState === XMLHttpRequest.DONE && xmlhttp.status === 200) {\n                const div     = document.createElement('div');\n                const parser  = new DOMParser();\n                const el      = parser.parseFromString(xmlhttp.response, 'text/html');\n                const element = el.body.firstChild;\n                div.classList.add('lightbox');\n                div.appendChild(element);\n                el_affiliate_popup.appendChild(div);\n\n                const el_affiliate_btn = document.getElementById('btn_affiliate_proceed');\n                el_affiliate_btn.removeEventListener('click', close);\n                el_affiliate_btn.addEventListener('click', close);\n\n                document.body.classList.add('scroll-lock');\n            }\n        };\n\n        xmlhttp.open('GET', urlFor('affiliate_disclaimer'), true);\n        xmlhttp.send();\n    }\n\n    function close() {\n        document.body.classList.remove('scroll-lock');\n        el_affiliate_popup.remove();\n    }\n}\n\nfunction isLoggedIn () {\n    /**\n     * Returns the client information\n     *\n     * @param {String|null} key     The property name to return the value from, if missing returns the account object\n     * @param {String|null} loginid The account to return the value from\n     */\n    function get(key, loginid = localStorage.getItem('active_loginid')) {\n        let value;\n        const client_object = getAllAccountsObject();\n        if (key === 'loginid') {\n            value = loginid || localStorage.getItem('active_loginid');\n        } else {\n            const current_client = client_object[loginid] || getAllAccountsObject()[loginid] || {};\n\n            value = key ? current_client[key] : current_client;\n        }\n        if (!Array.isArray(value) && (+value === 1 || +value === 0 || value === 'true' || value === 'false')) {\n            value = JSON.parse(value || false);\n        }\n        return value;\n    }\n\n    function getAllAccountsObject() {\n        return JSON.parse(localStorage.getItem('client.accounts'));\n    }\n\n    return get('loginid') && get('token');\n}\n"]}